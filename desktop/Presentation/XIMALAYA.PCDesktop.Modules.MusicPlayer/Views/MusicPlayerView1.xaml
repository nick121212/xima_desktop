<UserControl x:Class="XIMALAYA.PCDesktop.Modules.MusicPlayer.Views.MusicPlayerView1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:Controls="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:MControls="http://ximalaya.com/xaml/controls"
             xmlns:tools="http://ximalaya.com/xaml/tools/converter"
             xmlns:sound="clr-namespace:WPFSoundVisualizationLib;assembly=WPFSoundVisualizationLib"
             mc:Ignorable="d" 
             d:DesignWidth="700">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/XIMALAYA.PCDesktop.Controls;component/Themes/Generic.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <tools:TimeSpanToDoubleConverter x:Key="TimeSpanToDoubleConverter"/>
            <BooleanToVisibilityConverter x:Key="BoolToVisibility"></BooleanToVisibilityConverter>
            
        </ResourceDictionary>
    </UserControl.Resources>

    <DockPanel>
        <WrapPanel Orientation="Horizontal" DockPanel.Dock="Left" 
                   VerticalAlignment="Center" Margin="5 0">
            <Image Margin="5" Width="32" Height="32" Source="{Binding SoundInfo.PicUrl}"></Image>
            <TextBlock 
                MaxWidth="100"
                TextWrapping="Wrap"
                Text="{Binding SoundInfo.Title}" 
                VerticalAlignment="Center"/>
        </WrapPanel>
        <Grid DockPanel.Dock="Right" Width="250" 
                   VerticalAlignment="Center">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="3*" />
            </Grid.ColumnDefinitions>
            <MControls:PathButton 
                Grid.Column="0"
                Fill="{DynamicResource AccentColorBrush}"
                Background="{DynamicResource AccentColorBrush4}"
                IconHeight="16"
                IconWidth="16"
                Width="25"
                Height="25"
                IconDataChecked="M0,0L15.908,0 15.908,20.125872 28.130381,13.333224 52.118999,0 52.118999,26.66655 52.118999,53.333 28.130381,39.999775 15.908,33.20718 15.908,53.333 0,53.333z"
                IconData="M0,0L15.908,0 15.908,20.125872 28.130381,13.333224 52.118999,0 52.118999,26.66655 52.118999,53.333 28.130381,39.999775 15.908,33.20718 15.908,53.333 0,53.333z" />
            <MControls:PathButton 
                Grid.Column="1"
                Fill="{DynamicResource AccentColorBrush}"
                Background="{DynamicResource AccentColorBrush4}"
                IconHeight="20"
                IconWidth="20"
                Width="25"
                Height="25"
                IsChecked="{Binding BassEngine.IsPlaying,Mode=OneWay}"
                Command="{Binding BassEngine.PlayCommand}"
                CommandParameter="{Binding Source={RelativeSource Self},Path=IsChecked}"
                IconDataChecked="M27.270001,0L44.310001,0 44.310001,48.643002 27.270001,48.643002z M0,0L17.040001,0 17.040001,48.643002 0,48.643002z"
                IconData="F1M-224.553,1265L-246.174,1283.52 -267.792,1302.04 -267.792,1265 -267.792,1227.97 -246.174,1246.49 -224.553,1265z" >
            </MControls:PathButton>
            <MControls:PathButton 
                Grid.Column="2"
                Fill="{DynamicResource AccentColorBrush}"
                Background="{DynamicResource AccentColorBrush4}"
                IconHeight="16"
                IconWidth="16"
                Width="25"
                Height="25"
                MControls:RotationManager.Angle="-180"
                IconDataChecked="M0,0L15.908,0 15.908,20.125872 28.130381,13.333224 52.118999,0 52.118999,26.66655 52.118999,53.333 28.130381,39.999775 15.908,33.20718 15.908,53.333 0,53.333z"
                IconData="M0,0L15.908,0 15.908,20.125872 28.130381,13.333224 52.118999,0 52.118999,26.66655 52.118999,53.333 28.130381,39.999775 15.908,33.20718 15.908,53.333 0,53.333z" />
            <WrapPanel Grid.Column="3">
                <MControls:PathButton 
                    Fill="{DynamicResource AccentColorBrush}"
                    Background="{DynamicResource AccentColorBrush4}"
                    IconHeight="16"
                    IconWidth="16"
                    Width="25"
                    Height="25"
                    MControls:RotationManager.Angle="-90"
                    Command="{Binding ShowSpectrumAnalyzerCommand}"
                    IconDataChecked="M0,57.655001L67.002998,57.655001 67.002998,64.000002 0,64.000002z M0,42.505001L38.098999,42.505001 38.098999,48.85 0,48.85z M0,28.294L67.002998,28.294 67.002998,34.639 0,34.639z M0,14.143001L38.098999,14.143001 38.098999,20.488001 0,20.488001z M0,0L67.002998,0 67.002998,6.3460007 0,6.3460007z"
                    IconData="M0,57.655001L67.002998,57.655001 67.002998,64.000002 0,64.000002z M0,42.505001L38.098999,42.505001 38.098999,48.85 0,48.85z M0,28.294L67.002998,28.294 67.002998,34.639 0,34.639z M0,14.143001L38.098999,14.143001 38.098999,20.488001 0,20.488001z M0,0L67.002998,0 67.002998,6.3460007 0,6.3460007z" />
                <MControls:PathButton 
                    Fill="{DynamicResource AccentColorBrush}"
                    Background="{DynamicResource AccentColorBrush4}"
                    IconHeight="20"
                    IconWidth="20"
                    Width="25"
                    Height="25"
                    IsChecked="{Binding BassEngine.IsMuted}"
                    IconDataChecked="M38.668834,36.615738L38.413822,36.982094C35.291652,41.71722 35.812908,48.165199 39.974968,52.328129 44.137378,56.488868 50.584438,57.010032 55.319351,53.888809L55.687591,53.632545z M48.602794,31.503002C46.259212,31.503002,43.915767,32.17168,41.887081,33.509033L41.521537,33.763427 58.537567,50.782223 58.792633,50.415718C61.913654,45.681274 61.393482,39.232292 57.23212,35.069275 54.8526,32.691761 51.727573,31.503002 48.602794,31.503002z M48.602306,28.301C52.542572,28.300825 56.482925,29.804064 59.49007,32.811241 65.503559,38.824394 65.503063,48.573082 59.49007,54.586235 53.47578,60.60059 43.728656,60.60059 37.715068,54.586235 31.702978,48.573082 31.702978,38.824394 37.715068,32.811241 40.721862,29.804764 44.66204,28.301174 48.602306,28.301z M41.371997,0L41.371997,24.455753C38.66175,25.472755 36.168205,27.045658 34.058868,29.153763 30.173896,33.037971 28.034559,38.203281 28.034559,43.698097 28.034559,44.994896 28.162861,46.269699 28.395864,47.517002L21.404138,42.550892 18.962,40.815963 18.962,40.862999 0,40.862999 0,16.013 18.827118,16.013 21.404138,14.18243z"
                    IconData="M37.11425,16.797999C38.863781,18.269512 40.000999,20.44513 40.000999,22.904751 40.000999,25.365671 38.863781,27.541588 37.11425,29.013L34.195004,26.161377C35.258221,25.442572 36.001633,24.287663 36.001633,22.904751 36.001633,21.525938 35.258221,20.371029 34.195004,19.653523z M45.706963,8.4020007C49.562447,12.057141 52,17.184754 52,22.904881 52,28.627707 49.562447,33.75802 45.706963,37.4L42.836998,34.601839C45.99017,31.678474 47.999313,27.539183 47.999313,22.904881 47.999313,18.273278 45.99017,14.133986 42.836998,11.210622z M26.447412,5.4093134C27.376011,5.4274888,27.999001,6.2373606,27.999001,7.6814044L27.999001,39.680195C27.999001,41.879509,26.552422,42.507008,24.782248,41.203705L14.417795,33.453674C12.64952,32.14637 11.20104,30.975763 11.20104,31.094263 11.20104,31.208866 9.4002562,30.908064 7.2017679,30.908064L4.0005827,30.908064C1.8007544,30.908064,0,29.899059,0,27.703651L0,18.906717C0,16.706109,1.8007544,14.905302,4.0005827,14.905302L7.2017679,14.905302C9.4002562,14.905302 11.20104,15.173603 11.20104,15.491405 11.20104,15.818107 12.64952,15.012103 14.417795,13.708797L24.782248,6.0550587C25.390745,5.6074945,25.961004,5.3997924,26.447412,5.4093134z M54.316631,0C60.28199,5.8124751 64,13.92184 64,22.9048 64,31.889162 60.28199,39.999828 54.316631,45.811001L51.445004,43.006313C56.709175,37.907436 60.000095,30.794167 60.000095,22.9048 60.000095,15.019635 56.709175,7.8958361 51.445004,2.8060181z"/>
                <Slider 
                    Width="50" Height="5"
                    Maximum="1"
                    Minimum="0"
                    LargeChange="0.2"
                    SmallChange="0.1"
                    Value="{Binding BassEngine.Volume}"
                    Style="{DynamicResource FlatSlider}" />
            </WrapPanel>
        </Grid>
        <Grid VerticalAlignment="Top">
            <MControls:MetroSlider
                x:Name="metroSlider"
                Minimum="0"
                Maximum="{Binding RelativeSource={RelativeSource Self},Path=Duration}"
                ThumbBackground="{DynamicResource WhiteColorBrush}"
                ThumbForeground="{DynamicResource AccentColorBrush}"
                TrackBackgroundBack="{DynamicResource AccentColorBrush4}"
                TrackBackgroundFront="{DynamicResource AccentColorBrush}"
                TotalTimeSpan="{Binding RelativeSource={RelativeSource Self},Path=Value}"
                Duration="{Binding BassEngine.TotalTime,Converter={StaticResource TimeSpanToDoubleConverter}}"
                Value="{Binding BassEngine.CurrentTime,Converter={StaticResource TimeSpanToDoubleConverter}}"
                Process="{Binding BassEngine.Process}"
                Panel.ZIndex="10"
                LargeChange="5000"
                Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=WrapPanel}, Path=ActualWidth}"
                SmallChange="1000">
            </MControls:MetroSlider>
            <sound:SpectrumAnalyzer 
                x:Name="SpectrumAnalyzer"
                Opacity="0.5"
                Visibility="{Binding ShowSpectrumAnalyzer,Converter={StaticResource BoolToVisibility}}"
                Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=WrapPanel}, Path=ActualWidth}"
                Height="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=WrapPanel}, Path=ActualHeight}">
                <sound:SpectrumAnalyzer.BarStyle>
                    <Style TargetType="{x:Type Rectangle}">
                        <Setter Property="Fill">
                            <Setter.Value>
                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1" x:Name="BarBrush">
                                    <GradientStop Color="{DynamicResource AccentColor}" Offset="0"/>
                                    <GradientStop Color="{DynamicResource AccentColor4}" Offset="1"/>
                                </LinearGradientBrush>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </sound:SpectrumAnalyzer.BarStyle>
                <sound:SpectrumAnalyzer.PeakStyle>
                    <Style TargetType="{x:Type Rectangle}">
                        <Setter Property="Fill">
                            <Setter.Value>
                                <SolidColorBrush Color="{DynamicResource AccentColor2}" />
                            </Setter.Value>
                        </Setter>
                    </Style>
                </sound:SpectrumAnalyzer.PeakStyle>
            </sound:SpectrumAnalyzer>

        </Grid>
    </DockPanel>
</UserControl>
